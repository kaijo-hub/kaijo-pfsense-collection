type: leaky
name: kaijo/ssh-bruteforce-fast-pfsense
description: "Detect fast SSH bruteforce attacks based on repeated authentication failures"
author: kaijo
filter: |
  evt.Meta.log_type in ['ssh_auth_fail', 'ssh_permission_denied', 'ssh_pam_error'] && evt.Meta.source_ip != ''
groupby: evt.Meta.source_ip
leakspeed: 10s
capacity: 5
blackhole: 2m
labels:
  type: bruteforce
  service: ssh
  remediation: true
